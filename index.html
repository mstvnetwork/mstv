<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="MSTV Network offers a variety of live TV channels including music, movies, and more. Watch your favorite channels online for free.">
    <meta name="keywords" content="live TV, MSTV Network, free TV, live channels, streaming, music, bollywood, saga music">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="MSTV Network">
    <meta property="og:description" content="Stream live TV channels including music, movies and more on MSTV Network.">
    <meta property="og:image" content="https://raw.githubusercontent.com/mstvnetwork/mstv2/refs/heads/main/Design-Studio-2025-01-20%20(2).png">
    <meta property="og:url" content="https://mstvnet.netlify.app/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="MSTV Network">
    <meta name="twitter:description" content="Stream live TV channels including music, movies and more on MSTV Network.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/mstvnetwork/mstv2/refs/heads/main/Design-Studio-2025-01-20%20(2).png">
    <meta name="twitter:url" content="https://mstvnet.netlify.app/">

     <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "MSTV Network",
        "description": "Stream live TV channels including music, movies and more.",
        "url": "https://yourwebsite.com",
        "publisher": {
            "@type": "Organization",
            "name": "MSTV Network",
            "logo": {
                "@type": "ImageObject",
                "url": "https://raw.githubusercontent.com/mstvnetwork/mstv2/refs/heads/main/Design-Studio-2025-01-20%20(2).png"
            }
        }
    }
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HJFN0N9L63"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-HJFN0N9L63'); // REPLACE WITH YOUR MEASUREMENT ID
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <title>MSTV INDIA</title>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        html {
            font-size: 16px;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #fff;
            width: 100%;
            min-height: 100vh;
            overflow-x: hidden;
            background-color: #000; /* Set background to black */
        }

        .title-3d {
            font-size: 3.5em; /* Slightly larger for more impact */
            text-align: center;
            margin-top: 40px; /* Increased top margin */
            color: #00ffe7;
            text-shadow: 0 0 15px #00ffe7, 0 0 30px #0ff, 0 0 45px #0ff; /* Stronger glow */
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            0% { text-shadow: 0 0 10px #00ffe7, 0 0 20px #0ff; }
            100% { text-shadow: 0 0 20px #00ffe7, 0 0 30px #0ff; }
        }

        /* Viewer Count Styling */
        .viewer-count {
            text-align: center;
            font-size: 1.6em; /* Slightly larger */
            color: #f7ff00;
            text-shadow: 0 0 10px #f7ff00, 0 0 20px rgba(247, 255, 0, 0.7); /* Stronger glow */
            margin-top: 15px;
            font-weight: 600;
        }


        .scrolling-text {
            overflow: hidden;
            white-space: nowrap;
            padding: 14px 0; /* Slightly more padding */
            margin: 25px 0; /* Increased margin */
            background: rgba(255, 255, 255, 0.08); /* Slightly more visible background */
            border-top: 2px solid #00ffe7;
            border-bottom: 2px solid #00ffe7;
            box-shadow: 0 0 10px rgba(0, 255, 231, 0.3); /* Subtle shadow */
        }

        .scrolling-content {
            display: inline-block;
            padding-left: 100%;
            animation: scroll-text 18s linear infinite; /* Slightly slower scroll */
            font-size: 1.4em; /* Slightly larger */
            color: #00ffe7;
            text-shadow: 0 0 5px rgba(0, 255, 231, 0.5); /* Subtle text shadow */
        }

        @keyframes scroll-text {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-100%); }
        }

        * {
            box-sizing: border-box;
        }

        .channel-selector-text {
            text-align: center;
            font-size: 1.8em; /* More prominent */
            margin: 3vh 0 1.5vh; /* Increased margin */
            color: #ff70e4; /* Updated accent color */
            padding: 0 5vw;
            text-shadow: 0 0 8px rgba(255, 112, 228, 0.6); /* Subtle text shadow */
        }

        /* CSS Adjustment for better centering on desktop */
        .channel-selection {
            margin-bottom: 4vh; /* Increased margin */
            padding: 0 5vw;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        select {
            padding: 0.6em 1.2em; /* Slightly larger padding */
            font-size: 1.2em; /* Larger font */
            background: #111;
            color: #0ff;
            border: 2px solid #0ff;
            border-radius: 10px; /* Less rounded for a slightly sharper look */
            outline: none;
            transition: 0.3s;
            text-align: center;
            box-shadow: 0 0 15px #0ff; /* More prominent shadow */
            width: 100%;
            max-width: 450px; /* Slightly wider */
            display: block;
        }

        select:hover {
            background: #1f0037;
            color: #fff;
            box-shadow: 0 0 20px #ff70e4; /* Updated hover shadow */
        }

        .player-container {
            position: relative;
            width: 95%; /* Slightly wider */
            max-width: 1100px; /* Increased max width */
            aspect-ratio: 16 / 9;
            margin: 0 auto 50px; /* Increased bottom margin */
            border: 4px solid;
            border-radius: 15px; /* Less rounded */
            overflow: hidden;
            background: #000;
            animation: borderPulseUnique 4s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(255, 112, 228, 0.5); /* Subtle container shadow */
        }

        @keyframes borderPulseUnique {
            0% { border-color: #ff70e4; box-shadow: 0 0 20px #ff70e4; } /* Updated color */
            25% { border-color: #00ffe7; box-shadow: 0 0 35px #00ffe7; }
            50% { border-color: #ff70e4; box-shadow: 0 0 20px #ff70e4; } /* Updated color */
            75% { border-color: #f7ff00; box-shadow: 0 0 35px #f7ff00; }
            100% { border-color: #ff70e4; box-shadow: 0 0 20px #ff70e4; } /* Updated color */
        }

        .player-container iframe,
        .player-container video,
        #placeholder-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .unmute-button {
            position: absolute;
            bottom: 25px; /* Slightly more spacing */
            left: 25px; /* Slightly more spacing */
            background: rgba(0, 0, 0, 0.8); /* Slightly darker */
            border: 2px solid #00ffe7;
            border-radius: 5px; /* Less rounded */
            width: 55px; /* Slightly larger */
            height: 55px; /* Slightly larger */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 101;
            font-size: 2em; /* Larger icon */
            color: #fff;
            box-shadow: 0 0 12px rgba(0, 255, 231, 0.7); /* More prominent shadow */
            transition: background 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease; /* Added box-shadow transition */
            display: none; /* Controlled by JS */
        }

        .unmute-button:hover {
            background: rgba(0, 0, 0, 0.95); /* Darker on hover */
            border-color: #ff70e4; /* Updated hover border */
            box-shadow: 0 0 20px #ff70e4; /* More prominent hover shadow */
        }

        .live-stamp {
            position: absolute;
            top: 10px; /* Slightly more spacing */
            left: 10px; /* Slightly more spacing */
            background: #ff003c;
            color: white;
            padding: 10px 15px; /* Slightly larger padding */
            font-weight: bold;
            font-size: 1em; /* Slightly larger font */
            border-radius: 5px;
            z-index: 10;
            box-shadow: 0 0 12px #ff003c; /* More prominent shadow */
        }

        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.7em; /* Larger font */
            background: rgba(0, 0, 0, 0.9); /* Darker background */
            color: #ffcc00;
            padding: 20px 40px; /* Larger padding */
            border-radius: 10px; /* Less rounded */
            display: none;
            z-index: 15;
            text-align: center;
            animation: glowLoader 1.5s infinite alternate;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.8); /* More prominent shadow */
        }

        @keyframes glowLoader {
            0% { box-shadow: 0 0 8px #ffcc00; }
            100% { box-shadow: 0 0 20px #ffcc00; }
        }

        .logo-overlay {
            position: absolute;
            bottom: 15px; /* Slightly more spacing */
            right: 15px; /* Slightly more spacing */
            width: 70px; /* Slightly larger */
            height: auto;
            opacity: 0.9; /* More visible */
            z-index: 12;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.7)); /* Subtle shadow for the logo */
        }

        .partner-logos {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 40px; /* Increased gap */
            margin: 60px auto; /* Increased margin */
            padding: 0 30px; /* Increased padding */
            max-width: 1200px; /* Increased max width */
        }

        .partner-logos img {
            max-width: 200px; /* Slightly larger */
            height: auto;
            opacity: 0.9; /* More visible */
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            border-radius: 10px; /* Less rounded */
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2); /* Subtle shadow */
        }

        .partner-logos img:hover {
            transform: scale(1.1); /* More pronounced hover effect */
            opacity: 1;
            box-shadow: 0 0 20px #00ffe7,
                        0 0 30px rgba(0, 255, 231, 0.6); /* More prominent hover shadow */
        }

        audio {
            display: none;
        }

        footer {
            padding: 50px 20px; /* Increased padding */
            color: #ccc; /* Slightly lighter text */
            font-family: 'Poppins', sans-serif;
            border-top: 1px solid #222; /* Subtle top border */
            margin-top: 40px; /* Added top margin */
        }

        .footer-section {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: flex-start;
            max-width: 1200px;
            margin: 0 auto;
            gap: 30px; /* Increased gap */
            padding: 0 15px;
        }

        .footer-column {
            flex: 1 1 auto;
            min-width: 300px; /* Slightly wider */
            margin: 0;
            padding: 10px;
        }

        .footer-column h2 {
            color: #ff4f9b; /* Updated accent color */
            margin-bottom: 12px; /* Slightly more margin */
            font-size: 1.9rem; /* Slightly larger */
            font-weight: 600;
            letter-spacing: 0.06em;
            text-shadow: 0 0 6px rgba(255, 79, 155, 0.7); /* Subtle text shadow */
        }

        .footer-column h3, .footer-column h4 {
            color: #ff4f9b; /* Updated accent color */
            margin-top: 20px; /* Increased margin */
            margin-bottom: 8px; /* Slightly more margin */
            font-size: 1.35rem; /* Slightly larger */
            font-weight: 600;
            letter-spacing: 0.04em;
            text-shadow: 0 0 4px rgba(255, 79, 155, 0.5); /* Subtle text shadow */
        }

        .footer-column p {
            font-size: 0.95rem; /* Slightly larger */
            line-height: 1.8; /* Improved line height */
            color: #ddd; /* Slightly lighter text */
            letter-spacing: 0.03em;
            text-align: left; /* Align text to the left in the footer */
            margin-bottom: 1.7em; /* Increased margin */
        }

        .footer-column a {
            color: #ffe066; /* Updated link color */
            text-decoration: none;
            font-weight: 400;
            transition: color 0.3s ease;
        }

        .footer-column a:hover {
            text-decoration: underline;
            color: #fff;
        }

        .facebook-follow {
            text-align: center;
            margin-top: 50px; /* Increased margin */
            margin-bottom: 30px; /* Increased margin */
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .facebook-follow a {
            display: inline-flex;
            align-items: center;
            color: #fff;
            font-size: 1.3em; /* Slightly larger */
            text-decoration: none;
            background: #3b5998;
            padding: 12px 25px; /* Slightly larger padding */
            border-radius: 8px; /* Slightly less rounded */
            transition: background 0.3s ease, box-shadow 0.3s ease; /* Added box-shadow transition */
            box-shadow: 0 0 10px rgba(59, 89, 152, 0.7); /* Subtle shadow */
        }

        .facebook-follow a:hover {
            background: #2d4373;
            box-shadow: 0 0 15px rgba(59, 89, 152, 0.9); /* More prominent hover shadow */
        }

        .facebook-follow img {
            width: 35px; /* Slightly larger */
            height: 35px; /* Slightly larger */
            margin-right: 12px; /* Slightly more margin */
            filter: hue-rotate(300deg) saturate(500%) brightness(120%) contrast(100%) drop-shadow(2px 2px 3px rgba(0,0,0,0.6)); /* Added drop shadow */
            transition: filter 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 0 10px #ff0000,
                        0 0 20px rgba(255, 0, 0, 0.4);
        }

        .facebook-follow a:hover img {
            box-shadow: 0 0 15px #ff4500,
                        0 0 25px rgba(255, 69, 0, 0.6);
            filter: hue-rotate(305deg) saturate(600%) brightness(130%) contrast(100%);
        }

        .copyright {
            text-align: center;
            color: #999; /* Darker copyright text */
            margin-top: 30px; /* Increased margin */
            font-size: 0.85rem; /* Slightly larger */
            letter-spacing: 0.04em;
        }

        @media (max-width: 768px) {
            .footer-section {
                flex-direction: column;
                align-items: center;
                gap: 40px; /* Increased gap for mobile */
            }

            .footer-column {
                min-width: unset;
                width: 95%; /* Wider on mobile */
                text-align: left;
                padding: 15px; /* More padding on mobile */
            }

            .channel-selector-text {
                font-size: 1.6em; /* Slightly smaller on mobile */
            }

            select {
                font-size: 1.1em; /* Slightly smaller select on mobile */
                max-width: 90%; /* Wider select on mobile */
            }

            .player-container {
                width: 98%; /* Wider player on mobile */
                margin-bottom: 40px; /* Adjusted margin on mobile */
                border-radius: 10px; /* Less rounded on mobile */
            }

            .unmute-button {
                bottom: 15px; /* Adjusted position on mobile */
                left: 15px; /* Adjusted position on mobile */
                width: 45px; /* Slightly smaller on mobile */
                height: 45px; /* Slightly smaller on mobile */
                font-size: 1.6em; /* Smaller icon on mobile */
            }

            .live-stamp {
                top: 5px; /* Adjusted position on mobile */
                left: 5px; /* Adjusted position on mobile */
                font-size: 0.9em; /* Slightly smaller font on mobile */
                padding: 6px 10px; /* Smaller padding on mobile */
            }

            .logo-overlay {
                width: 50px; /* Smaller logo on mobile */
                bottom: 5px; /* Adjusted position on mobile */
                right: 5px; /* Adjusted position on mobile */
            }

            .partner-logos {
                gap: 20px; /* Smaller gap on mobile */
                margin: 30px auto; /* Adjusted margin on mobile */
                padding: 0 15px; /* Adjusted padding on mobile */
            }

            .partner-logos img {
                max-width: 150px; /* Smaller partner logos on mobile */
            }

            .facebook-follow a {
                font-size: 1.1em; /* Smaller font on mobile */
                padding: 10px 20px; /* Smaller padding on mobile */
            }

            .facebook-follow img {
                width: 30px; /* Smaller icon on mobile */
                height: 30px; /* Smaller icon on mobile */
                margin-right: 10px; /* Smaller margin on mobile */
            }
        }

        @media (max-width: 480px) {
            .footer-column {
                padding: 10px; /* Further adjusted padding on smaller mobile */
            }
        }
    </style>
</head>
<body>
    <div class="title-3d">MSTV INDIA</div>

    <div id="viewer-count" class="viewer-count"></div>

    <div class="scrolling-text">
        <div class="scrolling-content">Welcome to MSTV India - Refresh the webpage to auto-tune channels!</div>
    </div>

    <div class="channel-selector-text">Select Channel</div>
    <div class="channel-selection">
        <select id="channel-select">
            <option value="">👉📺📺📺</option>
            </select>
    </div>

    <div class="player-container" id="player-container">
        <iframe id="media-player" allow="autoplay; encrypted-media; picture-in-picture" sandbox="allow-scripts allow-same-origin allow-presentation"></iframe>
        <video id="video-player" autoplay muted playsinline controlsList="nodownload nofullscreen noremote playback" disablePictureInPicture></video>
        <img id="placeholder-image" src="Design-Studio-2025-01-22 (1).png" alt="Stream Placeholder" style="opacity: 0.7; box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);" />
        
        <div class="live-stamp">MSTV NETWORK</div>
        <div class="loading-indicator" id="loading">Loading stream...</div>
        <img src="/logo.png" class="logo-overlay" alt="MSTV Logo" />

        <div class="unmute-button" id="unmute-button">
            <span id="speaker-icon">🔇</span>
        </div>
    </div>

    <div class="partner-logos"> <img src="logo.img/images.png" alt="Partner Logo 1">
        <img src="logo.img/images (1).jpeg" alt="Partner Logo 2">
    </div>

    <div class="facebook-follow">
        <a href="https://www.facebook.com/share/16VZyWirq4/" target="_blank">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg" alt="Facebook Icon" />
            Follow us on Facebook
        </a>
    </div>

    <footer>
        <div class="footer-section">
            <div class="footer-column">
                <h2>About MSTV</h2>
                <p>MSTV Network is a non-profit platform offering free access to live TV channels, including entertainment, music, news, and more. We provide high-quality streaming to viewers worldwide, ensuring a diverse and engaging experience. Our mission is to make content from the Indian subcontinent accessible to everyone, fostering cultural exchange through free, reliable, and uninterrupted TV streaming.</p>

                <h3>Disclaimer</h3>
                <p>
                    MSTV Network provides access to publicly available channels from various sources on the internet for informational and entertainment purposes only. We do not control or guarantee the accuracy, availability, or legality of the content streamed. All content is provided "as is," and MSTV Network is not liable for any errors, interruptions, or damages arising from the use of our services. By using MSTV Network, you agree to comply with all applicable laws. For more details, please refer to our Terms of Service and Privacy Policy.
                </p>
                <h4>Terms of services</h4>
                <p>By using MSTV Network, you agree to comply with our terms of service...</p>
            </div>
            <div class="footer-column">
                <h2>Contact</h2>
                <p>Email: contact@mstvindia.com</p>
                <p>Phone: +001-305-242-4447 </p>
            </div>
        </div>

        <div class="copyright">© 2025 MSTV INDIA. All rights reserved.</div>
    </footer>

    <script>
        const select = document.getElementById('channel-select');
        const videoPlayer = document.getElementById('video-player');
        const iframePlayer = document.getElementById('media-player');
        const placeholder = document.getElementById('placeholder-image');
        const loading = document.getElementById('loading');
        const unmuteButton = document.getElementById('unmute-button');
        const speakerIcon = document.getElementById('speaker-icon');
        const viewerCountElement = document.getElementById('viewer-count');

        let hlsInstance = null;
        let channelsData = [];
        const githubJsonUrl = 'channels.json';
        const pollingInterval = 5000;

        let currentViewerCount = 0;
        const minViewers = 500;
        const maxViewers = 5000;
        const animationDuration = 2000;
        const updateInterval = 5000;

        function showLoading(show) {
            loading.style.display = show ? 'block' : 'none';
        }

        function updateSpeakerIcon() {
            // Only show the button if a video stream is active and muted
            if (videoPlayer.style.display === 'block' && videoPlayer.muted) {
                speakerIcon.textContent = '🔇';
                unmuteButton.style.display = 'flex';
            } else {
                speakerIcon.textContent = '🔊'; // Potentially show unmuted state, but keep button hidden
                unmuteButton.style.display = 'none'; // Always hide if not muted or not video player
            }
        }

        unmuteButton.addEventListener('click', () => {
            if (videoPlayer.style.display === 'block') {
                videoPlayer.muted = false;
                updateSpeakerIcon();
            }
        });

        videoPlayer.addEventListener('volumechange', updateSpeakerIcon);

        function playChannel(channel) {
            showLoading(true);

            videoPlayer.pause();
            if (hlsInstance) {
                hlsInstance.destroy();
                hlsInstance = null;
            }
            videoPlayer.removeAttribute('src');
            videoPlayer.load();

            iframePlayer.src = '';

            videoPlayer.style.display = 'none';
            iframePlayer.style.display = 'none';
            placeholder.style.display = 'none';
            unmuteButton.style.display = 'none'; // Hide button whenever a new channel is loaded

            if (channel.type === 'hls') {
                if (Hls.isSupported()) {
                    videoPlayer.style.display = 'block';
                    hlsInstance = new Hls();
                    hlsInstance.loadSource(channel.url);
                    hlsInstance.attachMedia(videoPlayer);
                    hlsInstance.on(Hls.Events.MANIFEST_PARSED, function() {
                        videoPlayer.muted = true;
                        videoPlayer.autoplay = true;
                        videoPlayer.play().then(() => {
                            showLoading(false);
                            updateSpeakerIcon(); // Show unmute button only if muted and playing
                        }).catch(e => {
                            console.error("Video playback failed (HLS):", e);
                            showLoading(false);
                            placeholder.style.display = 'block';
                            unmuteButton.style.display = 'none';
                        });
                    });
                    hlsInstance.on(Hls.Events.ERROR, function (event, data) {
                        console.error('HLS.js error:', data);
                        if (data.fatal) {
                            switch(data.type) {
                                case Hls.ErrorTypes.NETWORK_ERROR:
                                    console.error('Fatal network error encountered, try to recover');
                                    hlsInstance.startLoad();
                                    break;
                                case Hls.ErrorTypes.MEDIA_ERROR:
                                    console.error('Fatal media error encountered, try to recover');
                                    hlsInstance.recoverMediaError();
                                    break;
                                default:
                                    hlsInstance.destroy();
                                    showLoading(false);
                                    placeholder.style.display = 'block';
                                    unmuteButton.style.display = 'none';
                                    break;
                            }
                        }
                    });

                } else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                    videoPlayer.style.display = 'block';
                    videoPlayer.src = channel.url;
                    videoPlayer.muted = true;
                    videoPlayer.autoplay = true;
                    videoPlayer.play().then(() => {
                        showLoading(false);
                        updateSpeakerIcon(); // Show unmute button only if muted and playing
                    }).catch(e => {
                        console.error("Video playback failed (Native HLS):", e);
                        showLoading(false);
                        placeholder.style.display = 'block';
                        unmuteButton.style.display = 'none';
                    });
                } else {
                    showLoading(false);
                    placeholder.style.display = 'block';
                    unmuteButton.style.display = 'none';
                }
            } else if (channel.type === 'iframe') {
                iframePlayer.style.display = 'block';
                iframePlayer.src = channel.url;
                unmuteButton.style.display = 'none'; // Ensure unmute button is always hidden for iframes

                iframePlayer.onload = () => {
                    showLoading(false);
                };
                iframePlayer.onerror = () => {
                    console.error("Iframe failed to load.");
                    showLoading(false);
                    placeholder.style.display = 'block';
                };
            } else { // Fallback for direct video (non-HLS, non-iframe)
                videoPlayer.style.display = 'block';
                videoPlayer.src = channel.url;
                videoPlayer.muted = true;
                videoPlayer.autoplay = true;
                videoPlayer.play().then(() => {
                    showLoading(false);
                    updateSpeakerIcon(); // Show unmute button only if muted and playing
                }).catch((error) => {
                    console.error("Video playback failed (direct video):", error);
                    showLoading(false);
                    placeholder.style.display = 'block';
                    unmuteButton.style.display = 'none';
                });
            }
        }

        function updateChannelDropdown(data) {
            const currentSelectedValue = select.value;
            select.innerHTML = '<option value="">👉📺📺📺</option>';

            data.forEach((channel, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = channel.name;
                select.appendChild(option);
            });
            console.log('Channel dropdown updated.');

            if (currentSelectedValue !== "") {
                const reselectIndex = parseInt(currentSelectedValue, 10);
                if (!isNaN(reselectIndex) && reselectIndex < data.length) {
                    select.value = reselectIndex;
                } else {
                    select.value = "";
                }
            }
        }

        async function fetchAndPopulateChannels() {
            try {
                const urlWithCacheBuster = `${githubJsonUrl}?cacheBuster=${new Date().getTime()}`;
                const response = await fetch(urlWithCacheBuster);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                console.log('Fetching channels.json data.');
                channelsData = data;
                updateChannelDropdown(channelsData);

            } catch (error) {
                console.error('Failed to fetch or process channels data:', error);
            }
        }

        select.addEventListener('change', () => {
            const selectedIndex = select.value;
            if (selectedIndex === "") {
                // If the placeholder is selected, clear everything and hide unmute button
                videoPlayer.pause();
                if (hlsInstance) {
                    hlsInstance.destroy();
                    hlsInstance = null;
                }
                videoPlayer.removeAttribute('src');
                iframePlayer.src = '';
                videoPlayer.style.display = 'none';
                iframePlayer.style.display = 'none';
                placeholder.style.display = 'block';
                unmuteButton.style.display = 'none'; // Explicitly hide when no channel is selected
                showLoading(false);
                return;
            }
            const selectedChannel = channelsData[selectedIndex];
            if (selectedChannel) {
                playChannel(selectedChannel);
            }
        });

        function getRandomViewerCount(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function animateViewerCount(start, end, duration) {
            let startTime = null;

            function step(timestamp) {
                if (!startTime) startTime = timestamp;
                const progress = Math.min((timestamp - startTime) / duration, 1);
                const current = Math.floor(start + (end - start) * progress);
                viewerCountElement.textContent = `Viewers: ${current.toLocaleString()}`;

                if (progress < 1) {
                    requestAnimationFrame(step);
                } else {
                    currentViewerCount = end; // Ensure the final value is set
                }
            }
            requestAnimationFrame(step);
        }

        function updateViewerCount() {
            const newViewerCount = getRandomViewerCount(minViewers, maxViewers);
            animateViewerCount(currentViewerCount, newViewerCount, animationDuration);
        }

        document.addEventListener('DOMContentLoaded', () => {
            fetchAndPopulateChannels();
            // Optionally auto-select the first channel if available
            // if (channelsData.length > 0) {
            //     select.value = 0;
            //     playChannel(channelsData[0]);
            // } else {
            //     placeholder.style.display = 'block';
            //     showLoading(false);
            // }
            placeholder.style.display = 'block'; // Ensure placeholder is visible initially
            showLoading(false); // Ensure loading is hidden initially

            // Initial viewer count display
            currentViewerCount = getRandomViewerCount(minViewers, maxViewers);
            viewerCountElement.textContent = `Viewers: ${currentViewerCount.toLocaleString()}`;
            setInterval(updateViewerCount, updateInterval);
        });
    </script>
</body>
</html>
